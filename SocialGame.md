# ソーシャルゲーム開発

## ディレクトリ構成
* root
  * master
  * api
  * realtime
  * multi
  * batch
  * admin
  * infra
  * document
  * ci
    * Jenkinsfiles

## DB構成
* User (Sharding)
* Game\[, Share, Common\]
* Log (Partition)
* Kpi

### 注意
* 対象範囲が漏れるので `23:59:59` や `BETWEEN` を使わない
  * 必ず `2018-01-01 00:00:00 <= x < 2018-01-02 00:00:00` で比較する

## クライアント
* 本番アプリのコードにデバッグ用コードは含めない `#if DEBUG`
* アセットの容量はファイル毎に管理できるようにしておく

## サーバー
* 個数のあるものは上限（と下限）を設定する。
* ゲーム内通貨もアイテムとして扱った方が楽かも。
* ヘルスチェック用 API を用意しておく

## 要設計
* 例外・エラー
* バリデーション `check~` `validate~`
* ログ
  * エラー箇所や原因を特定できるようになっているか
  * 対応しないといけないものだけエラーログに出力する（メンテはエラーログに出さない）
* デバッグコマンド
  * サーバーはデプロイしない or ユーザー判定して弾く
  * クライアントはバイナリいじったら有効にできてしまうのでそもそもコード自体含めない方が良い

## 課金設計
### 方針
全てアイテムとして扱う。複数種類のアイテムをセット販売できるようにする。  
効果を即適用したい場合はアイテムとして付与したのち使用させる。

### CSV
`Item.csv`, `Payment.csv`, `Payment_items.csv`
