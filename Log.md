# ログ

## 要件
- エラー箇所や原因を特定できるようになっているか
- 対応しないといけないものだけエラーログに出力する（メンテはエラーログに出さない）
  - 本番環境のログレベルを error, warning, info の３段階にしておく
- パスワードや認証情報はログに出力しない

## 保存先
- ファイル
- DB
  - DB 接続エラーを保存できない
- BigQuery
- Kibana
- Sentry

## パーティション
- 1日毎または1ヶ月毎にパーティションを切る
  - DROP は一瞬なので1ヶ月で良さそうだがバックアップの時間は要考慮
- pmax パーティションは作らない
- 管理はバッチで行う
  - 対象テーブルリスト生成
    - テーブル
    - カラム
  - CREATE
  - DUMP, ADD, DROP
- 未来のパーティションが作成されているか監視する仕組みを作る
  - 1日1回未来の日付のパーティションがあるか確認する（対応する余裕を持たせる）

## 不正検知
- 不正検知したユーザーは DB に理由と回数を保存しておく
  - user_id, reason_id, count
